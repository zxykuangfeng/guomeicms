<!--{php168}-->
<!--{template $this_module header admin}-->

<form action="" name="form" id="form" method="POST">
<div class="mainbox mainborder">
	<div class="section">
		<div class="section-operation">
			<h3>操作说明：</h3>
			<div class="operation-text">角色组没有实际功能，主要用于收纳角色放置。同时角色组可以设置开放设置注册，并个性化设置注册字段。</div>
		</div>
	</div>
</div>
<div class="mainbox mainborder">
		<div class="section">
			<table width="100%" border="0"  class="mainbox">
				<tr>
					<td>
						<ul class="boxmenu">
							<li class="btn-color1"><a href="{$core.admin_controller}/core/role-add_group" target="_blank"><i class="icon icon-ico44"></i>添加角色组</a></li>
							<li class="btn-color2"><a href="{$core.admin_controller}/core/role-list_group"><i class="icon icon-ico12"></i>角色组列表</a></li>
						</ul>
					</td>
				</tr>
			</table>
		
			<table class="columntable formtable hover_table">
				<tr class="title fix_head">
					<td width="3%" class="title">ID</td>
					<td width="10%" class="title">{$P8LANG['role_group']}</td>
					<td width="10%" class="title">{$P8LANG['role_group_registrable']}</td>
					<td width="5%" class="title">{$P8LANG['list_order']}</td>
					<td width="5%" class="title">{$P8LANG['operation']}</td>
				</tr>
				
				<!--{foreach $this_module->groups $id $value}-->
				<tr>
					<td>$id</td>
					<td>{$value['name']}</td>
					<td align="center">
						<img src="{$SKIN}/{if $value['registrable']}check_yes.gif{else}check_no.gif{/if}" />
					</td>
					<td align="center"><input type="text" name="display_order[$value[id]]" value="{$value['display_order']}" size="5" /></td>
					<td align="center">
						<a href="$this_router-list_group_field?gid={$value['id']}">{$P8LANG['list_role_group_field']}</a>
						<a href="$this_router-add_group_field?gid={$value['id']}">{$P8LANG['add_role_group_field']}</a>
						<a href="$this_router-update_group?id={$value['id']}">{$P8LANG['edit']}</a>
						<!--{if !in_array($value['id'], array($core->CONFIG['administrator_role_group'], $core->CONFIG['person_role_group']))}-->
						<a href="javascript:void(0)" id="group_$value[id]" onclick="return _delete_group(this)">{$P8LANG['delete']}</a>
						<!--{/if}-->
					</td>
				</tr>
				<!--{/foreach}-->
				
			</table>
		</div>
</div>
<div class="mainbox mainborder">
		<div class="section">
			<input type="submit" class="submit_btn" />
		</div>
</div>
</form>

<script type="text/javascript">
function _delete_group(obj){
	//if(!confirm('$P8LANG[confirm_to_delete]')) return false;
	p8_window.confirm('{$P8LANG['confirm_to_delete']}', function (r) {
		if(r){
			var id = parseInt(obj.id.replace(/[^0-9]/g, ''));	
			$.ajax({
				url: '$this_router-delete_group',
				type: 'post',
				data: {id: id},
				beforeSend: function(){
					ajaxing({});
				},
				success: function(status){
					ajaxing({action: 'hide'});
					if(status == 1){
						$(obj).parent().parent().remove();
					}
				}
			});
			
			return false;
		}else{
			return;
		}
	});	
}
$('form input[name^=display_order]').change(function(){
		this.value = this.value.replace(/[^0-9]/g, '') || 0;
		if(this.value > 255) this.value = 255;
		if(this.value < 0) this.value = 0;
		
		$('#form').append('<input type="hidden" name="_display_order['+ this.name.replace(/[^0-9]/g, '') +']" value="'+ this.value +'" />');
		$(this).css({border: '1px solid #ff0000'});
	});
</script>

<!--{template $core footer admin}-->

<!--{/php168}-->