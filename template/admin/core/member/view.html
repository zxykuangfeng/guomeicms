<!--{php168}-->
<!--{template $core header admin}-->

<form action="$this_url" method="post" id="form">
	<div class="mainbox mainborder">
		<div class="section">
			<table border="0" width="100%" cellpadding="0" cellspacing="0">
				<tr><td>
					<table class="columntable formtable hover_table">
						<tr>
							<td colspan="2" class="title">{$P8LANG['profile']}</td>
						</tr>						
						<!--{if $ACTION == 'update'}-->
						<tr>
							<td class="{$tdL}">{$P8LANG['id']}</td>
							<td class="tdR">
								<input type="text" class="txt" size="35" value="{$data['id']}" disabled />
							</td>
						</tr>
						<!--{/if}-->
						
						<tr>
							<td class="{$tdL}">{$P8LANG['username']}</td>
							<td class="tdR">
								{$data['username']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['email']}</td>
							<td class="tdR">
								{$data['email']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['name']}</td>
							<td class="tdR">
								{$data['name']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['address']}</td>
							<td class="tdR">
								{$data['address']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['phone']}</td>
							<td class="tdR">
								{$data['phone']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['cell_phone']}</td>
							<td class="tdR">
								{$data['cell_phone']}
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['department']}</td>
							<td class="tdR">
								{if $data['dept']}{$dept[$data['dept']]}{/if}
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['last_login_ip']}</td>
							<td class="tdR">
								{$data['last_login_ip']}
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['register_time']}</td>
							<td class="tdR">
								<!--{php echo $data['register_time'] ? date('Y-m-d H:i',$data['register_time']) : '';}-->
							</td>
						</tr>						
						<tr>
							<td class="{$tdL}">{$P8LANG['last_login_time']}</td>
							<td class="tdR">
								<!--{php echo $data['last_login'] ? date('Y-m-d H:i',$data['last_login']) : '';}-->
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['login_time']}</td>
							<td class="tdR">
								{$data['login_time']}
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['role_group']}</td>
							<td class="tdR">
								{$core.role_groups[$data['role_gid']]['name']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['role']}</td>
							<td class="tdR">
								{$core.roles[$data['role_id']]['name']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['member_status']['']}</td>
							<td class="tdR">
								{$P8LANG['member_status'][$data['status']]}
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['join_contact_list']}</td>
							<td class="tdR">
								{if !empty($data['is_email_manager'])}{else}x{/if}
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['short_message_user']}</td>
							<td class="tdR">
								{if !empty($data['is_message_user'])}&#10003;{else}x{/if}
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">管理员</td>
							<td class="tdR">
								{if !empty($data['is_admin'])}&#10003;{else}x{/if} 
								<span class="point">此身份之人可登录后台。</span>
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['founder']}</td>
							<td class="tdR">
								{if !empty($data['is_founder'])}&#10003;{else}x{/if} 
								<span class="point">此身份之人不受任何权限控制，慎用。</span>
							</td>
						</tr>
						<!--{foreach $this_model['fields'] $field $v}-->
						<tr>
							<td class="{$tdL}">$v[alias]</td>
							<td class="tdR">
								<!--{php
									switch($v['widget']){
										case 'text': case 'textarea': case 'editor': case 'editor_basic': case 'editor_basic'://字段输入方式为：输入杠、文本、编辑器
								}-->
										$data[$field]
										<!--{php
										break;
										
										case 'checkbox': case 'multi_select':
											foreach($v['data'] as $value => $key){
												if(in_array($value, $data[$field])){
								}-->
										$key
										<!--{php
												}
											}
										break;
										
										case 'select': case 'radio'://字段输入方式为：单选
											foreach($v['data'] as $value => $key){
												if($value == $data[$field]){
								}-->
										<!--{php echo is_array($key) ? $key[0] : $key;}-->
										<!--{php
													break;
												}
											}
										break;
										
										case 'uploader'://字段输入方式为：上传器
								}-->
										<a href="{$data[$field]['url']}" target="_blank">{$data[$field]['title']} 查看附件</a>
										<!--{php
										break;
										case 'image_uploader'://字段输入方式为：图片上传器
								}-->
										<span class="mbottom"> <a href="{$data[$field]['url']}" target="_blank"><img src="{$data[$field]['thumb']}" /></a> </span>
										<!--{php
										break;
										
										case 'multi_uploader'://字段输入方式为：多上传器
										foreach($data[$field] as $vv){
										if(preg_match("/[.+](jpg|jpeg|gif|png|bmp)$/i",$vv['url'])){
											}-->
										<span class="mbottom"> <a href="$vv[url]" target="_blank"><img src="$vv[thumb]" /></a> </span><br/>
										<!--{php
											}else{
											}-->
										<div class="mbottom">
											<a href="$vv[url]" target="_blank">{$vv['title']}</a>
										</div>
										<!--{php
											}
										}	
										break;
										case 'video_uploader'://字段输入方式为：视频上传器
								}-->
										<div>
											<script type="text/javascript" src="{$RESOURCE}/js/media.js"></script>
											<!--{if !empty($data[$field])}-->
											<script type="text/javascript">
											showMedia({
												url: '$data[video_url]',
												width: 550,
												height: 400
											});
											</script>
											<!--{/if}-->
										</div>
										<!--{php
										break;
										
									case 'city'://城市选择
									
									
								}-->										
									<span id="{$field}_path"></span>
									<input type="hidden" name="#field_{$field}_posted" />
									<input type="hidden" id="fields_$field" value="{if isset($data[$field])}$data[$field]{else}{$v['default_value']}{/if}" />
									<script type="text/javascript">
									$(function(){
										var dialog = new P8_Dialog({
											title_text: '{$P8LANG['select_city']}',
											width: 700,
											height: 300,
											button: true,
											show: function(){
												selector.init();
											},
											ok: function(){
												var v = selector.get_value();
												
												$('#fields_{$field}').val(v);												
												path(v);
											}
										});
										
										var selector;
										include_once('{$RESOURCE}/js/recursive_city.js', function(){
											selector = new Recursive_Selector({
												dialog: dialog,
												sub_property: 'areas',
												input: $('input[name="#field_{$field}_posted"]'),
												value: $('#fields_{$field}').val(),
												url: P8CONFIG.url +'/api/city.php',
												item_callback: function(area, item){
													
													if(area.areas){
														item.addClass('sub_category');
													}
												},
												init_callback: function(){
													var id = this.get_value();
													
													path(id);
												}
											});
											
											if($('#fields_{$field}').val()){
												selector.init();
											}
										});
										
										function path(id){
											if(id == 0){
												$('#{$field}_path').html('');
												return;
											}
											
											var tmp = selector.get_by_id(id);
											var html = '';
											
											while(true){
												html = tmp.name +' &gt; '+ html;
												if(tmp.parent == 0) break;
												
												tmp = selector.get_by_id(tmp.parent);
											}
											
											$('#{$field}_path').html(html);
										}
										
										$('#{$field}_button').click(function(){
											dialog.show();
										});
									});
									</script>
										<!--{php
									break;
									case 'link'://超链接
								}-->
								<a href="$data[$field]" target="{if !empty($v['data']['target'])}{$v['data']['target']}{/if}">$data[$field]</a>
										
										<!--{php
									break;
									case 'linkage'://多级联动
								}-->
									<!--{php $split='';}-->
									<!--{foreach $data[$field] $k=>$vl}-->
										{$split}{$vl}
									<!--{php $split='&nbsp;&gt;&nbsp;';}-->
									<!--{/foreach}-->	
										<!--{php
									break;
										default://其它输入方式
								}-->
										$data[$field]
										<!--{php
									}
								}-->
							</td>
						</tr>
						<!--{/foreach}-->
						<tr>
							<td class="{$tdL}">密保问题1：</td>
							<td class="tdR">							
								<select name="find_pwd[1][order]">
									<option value="">请选择密保问题</option>
									<!--{foreach $questions $order $question}-->
									<option value="{$order}" {if $order == $find_pwd[1]['order']} selected{/if}>{$question}</option>
									<!--{/foreach}-->
								</select><br>
								答案：{$find_pwd[1][ans]} 正确回答2个问题即可重置密码
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">密保问题2：</td>
							<td class="tdR">								
								<select name="find_pwd[2][order]">
									<option value="">请选择密保问题</option>
									<!--{foreach $questions $order $question}-->
									<option value="{$order}" {if $order == $find_pwd[2]['order']} selected{/if}>{$question}</option>
									<!--{/foreach}-->
								</select><br>
								答案：{$find_pwd[2][ans]} 正确回答2个问题即可重置密码
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">密保问题3：</td>
							<td class="tdR">							
								<select name="find_pwd[3][order]">
									<option value="">请选择密保问题</option>
									<!--{foreach $questions $order $question}-->
									<option value="{$order}" {if $order == $find_pwd[3]['order']} selected{/if}>{$question}</option>
									<!--{/foreach}-->
								</select><br>
								答案：{$find_pwd[3][ans]} 正确回答2个问题即可重置密码
							</td>
						</tr>
						<tr>
							<td class="{$tdL}">{$P8LANG['register_time']}</td>
							<td class="tdR">
								<!--{php echo date('Y-m-d H:i:s', $data['register_time']);}-->
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['last_login_time']}</td>
							<td class="tdR">
								<!--{php echo date('Y-m-d H:i:s', $data['last_login']);}-->
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['last_login_ip']}</td>
							<td class="tdR">
								{$data['last_login_ip']}
							</td>
						</tr>
						
						<tr>
							<td class="{$tdL}">{$P8LANG['login_time']}</td>
							<td class="tdR">
								{$data['login_time']}
							</td>
						</tr>
						<tr>
						  <td class="{$tdL}">&nbsp;</td>
						  <td class="tdR">
							<!--{if $ACTION == 'update'}-->						
							<input type="submit" value="{$P8LANG['submit']}" class="submit_btn"/>
							<!--{else}-->
							<a class="submit_btn" style="color:white;" href="$this_router-update?id={$data['id']}&role_gid={$data['role_gid']}" target="_blank">编辑用户</a>
							<!--{/if}-->
							</td>
						</tr>						
					</table>
				</td></tr>
			</table>
		</div>
	</div>
	<input type="hidden" name="id" value="{if !empty($data['id'])}{$data['id']}{/if}" />
</form>

<script type="text/javascript">

</script>

<!--{template $core footer admin}-->
<!--{/php168}-->